{
  "version": 3,
  "file": "mktscript.test.js",
  "sourceRoot": "../..",
  "sources": [
    "src/tests/mktscript.test.coffee"
  ],
  "names": [],
  "mappings": "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",
  "sourcesContent": [
    "###\n\n====================================================================================\ncompact names for MKTScript:\n\n`<div#c432.foo.bar>...</div>` => `<div id=c432 class='foo bar'>...</div>`\n`<p.noindent>...</p>` => `<p class=noindent>...</p>`\n\npositional arguments:\n`<columns:2>` => `<columns count=2/>` => `<columns count=2></columns>` ?=> `<mkts-columns count=2></mkts-columns>`\n\nNB Svelte uses capitalized names, allows self-closing tags(!): `<Mytag/>`\n\n###\n\n'use strict'\n\n############################################################################################################\nCND                       = require 'cnd'\nrpr                       = CND.rpr\nbadge                     = 'INTERTEXT/TESTS/MKTSCRIPT'\nlog                       = CND.get_logger 'plain',     badge\ninfo                      = CND.get_logger 'info',      badge\nwhisper                   = CND.get_logger 'whisper',   badge\nalert                     = CND.get_logger 'alert',     badge\ndebug                     = CND.get_logger 'debug',     badge\nwarn                      = CND.get_logger 'warn',      badge\nhelp                      = CND.get_logger 'help',      badge\nurge                      = CND.get_logger 'urge',      badge\necho                      = CND.echo.bind CND\n{ jr, }                   = CND\n#...........................................................................................................\nDATOM                     = new ( require 'datom' ).Datom { dirty: false, }\n{ new_datom\n  lets\n  select }                = DATOM.export()\ntypes                     = require '../types'\n{ isa\n  validate\n  # cast\n  # declare\n  # declare_cast\n  # check\n  # sad\n  # is_sad\n  # is_happy\n  type_of }               = types\n#...........................................................................................................\ntest                      = require 'guy-test'\nINTERTEXT                 = require '../..'\n{ MKTS, }                 = INTERTEXT\n\n\n#===========================================================================================================\n# TESTS\n#-----------------------------------------------------------------------------------------------------------\n@[ \"MKTS.html_as_datoms\" ] = ( T, done ) ->\n  probes_and_matchers = [\n    [\"line A<br/>line B\",[{\"text\":\"line A\",\"$key\":\"^text\"},{\"$key\":\"^br\"},{\"text\":\"line B\",\"$key\":\"^text\"}],null]\n    [\"<p>|here and|<br>\",[{\"$key\":\"<p\"},{\"text\":\"|here and|\",\"$key\":\"^text\"},{\"$key\":\"<br\"}],null]\n    [\"|foo |<p>|here and|<br>|there|\",[{\"text\":\"|foo |\",\"$key\":\"^text\"},{\"$key\":\"<p\"},{\"text\":\"|here and|\",\"$key\":\"^text\"},{\"$key\":\"<br\"},{\"text\":\"|there|\",\"$key\":\"^text\"}],null]\n    [\"< >\",[{\"message\":\"Syntax error: whitespace not allowed here: \\\"< >\\\"\",\"type\":\"mkts-syntax-html\",\"source\":\"< >\",\"$key\":\"~error\"}],null]\n    [\"< x >\",[{\"message\":\"Syntax error: whitespace not allowed here: \\\"< x >\\\"\",\"type\":\"mkts-syntax-html\",\"source\":\"< x >\",\"$key\":\"~error\"}],null]\n    [\"<>\",[{\"message\":\"Syntax error: closing bracket too close to opening bracket: \\\"<>\\\"\",\"type\":\"mkts-syntax-html\",\"source\":\"<>\",\"$key\":\"~error\"}],null]\n    [\"<\",[{\"message\":\"Syntax error: opening but no closing bracket: \\\"<\\\"\",\"type\":\"mkts-syntax-html\",\"source\":\"<\",\"$key\":\"~error\"}],null]\n    [\"<tag\",[{\"message\":\"Syntax error: opening but no closing bracket: \\\"<tag\\\"\",\"type\":\"mkts-syntax-html\",\"source\":\"<tag\",\"$key\":\"~error\"}],null]\n    [\"tag>\",[{\"message\":\"Syntax error: closing but no opening bracket: \\\"tag>\\\"\",\"type\":\"mkts-syntax-html\",\"source\":\"tag>\",\"$key\":\"~error\"}],null]\n    [\">\",[{\"message\":\"Syntax error: closing but no opening bracket: \\\">\\\"\",\"type\":\"mkts-syntax-html\",\"source\":\">\",\"$key\":\"~error\"}],null]\n    [\"<\",[{\"message\":\"Syntax error: opening but no closing bracket: \\\"<\\\"\",\"type\":\"mkts-syntax-html\",\"source\":\"<\",\"$key\":\"~error\"}],null]\n    [\"x\",[{\"text\":\"x\",\"$key\":\"^text\"}],null]\n    [\"&\",[{\"text\":\"&\",\"$key\":\"^text\"}],null]\n    [\"&;\",[{\"text\":\"&;\",\"$key\":\"^text\"}],null]\n    [\"&&\",[{\"text\":\"&&\",\"$key\":\"^text\"}],null]\n    [\"max & moritz\",[{\"text\":\"max & moritz\",\"$key\":\"^text\"}],null]\n    [\"&amp;\",[{\"text\":\"&amp;\",\"$key\":\"^text\"}],null]\n    [\"<tag>\\n \\n\\t\\n</p>\",[{\"$key\":\"<tag\"},{\"text\":\"\\n \\n\\t\\n\",\"$key\":\"^text\"},{\"$key\":\">p\"}],null]\n    [\"<tag a='<'>\",[{\"message\":\"Syntax error: additional opening bracket: \\\"<tag a='<'>\\\"\",\"type\":\"mkts-syntax-html\",\"source\":\"<tag a='<'>\",\"$key\":\"~error\"}],null]\n    [\"<tag a='>'>\",[{\"text\":\">\",\"$key\":\"^text\"},{\"message\":\"Syntax error: closing but no opening bracket: \\\"'>\\\"\",\"type\":\"mkts-syntax-html\",\"source\":\"'>\",\"$key\":\"~error\"}],null]\n    [\"if <math> a > b </math> then\",[{\"text\":\"if \",\"$key\":\"^text\"},{\"$key\":\"<math\"},{\"message\":\"Syntax error: closing before opening bracket: \\\" a > b </math> then\\\"\",\"type\":\"mkts-syntax-html\",\"source\":\" a > b </math> then\",\"$key\":\"~error\"}],null]\n    ]\n  for [ probe, matcher, error, ] in probes_and_matchers\n    await T.perform probe, matcher, error, -> return new Promise ( resolve, reject ) ->\n      text      = probe\n      resolve MKTS.html_as_datoms text\n  #.........................................................................................................\n  done()\n  return null\n\n#-----------------------------------------------------------------------------------------------------------\n@[ \"MKTS.html_as_datoms (compact syntax)\" ] = ( T, done ) ->\n  probes_and_matchers = [\n    # [ '<columns =2 =3>' ]\n    [\"<div>\",[{\"$key\":\"<div\"}]]\n    [\"<div#c432.foo.bar>\",[{\"$key\":\"<div\",\"id\":\"c432\",\"class\":\"foo bar\"}]]\n    [\"<p.noindent>\",[{\"$key\":\"<p\",\"class\":\"noindent\"}]]\n    ]\n  for [ probe, matcher, error, ] in probes_and_matchers\n    await T.perform probe, matcher, error, -> return new Promise ( resolve, reject ) ->\n      resolve MKTS.html_as_datoms probe\n  #.........................................................................................................\n  done()\n  return null\n\n#-----------------------------------------------------------------------------------------------------------\n@[ \"MKTS.$html_as_datoms\" ] = ( T, done ) ->\n  SP                        = require 'steampipes'\n  # SP                        = require '../../apps/steampipes'\n  { $\n    $async\n    $drain\n    $watch\n    $show  }                = SP.export()\n  #.........................................................................................................\n  probe         = \"\"\"\n    <p>A <em>concise</em> introduction to the things discussed below.</p>\n    \"\"\"\n  matcher = [{\"$key\":\"<p\"},{\"text\":\"A \",\"$key\":\"^text\"},{\"$key\":\"<em\"},{\"text\":\"concise\",\"$key\":\"^text\"},{\"$key\":\">em\"},{\"text\":\" introduction to the things discussed below.\",\"$key\":\"^text\"},{\"$key\":\">p\"}]\n  #.........................................................................................................\n  pipeline      = []\n  pipeline.push [ ( Buffer.from probe ), ]\n  pipeline.push SP.$split()\n  pipeline.push MKTS.$html_as_datoms()\n  pipeline.push $show()\n  pipeline.push $drain ( result ) =>\n    help jr result\n    T.eq result, matcher\n    done()\n  SP.pull pipeline...\n  #.........................................................................................................\n  return null\n\n#-----------------------------------------------------------------------------------------------------------\n@[ \"MKTS.html_as_datoms (dubious)\" ] = ( T, done ) ->\n  probes_and_matchers = [\n    ### TAINT these edge cases should be solved by an appropriate (MKTScript) pre-processor; NB that in\n    MKTScript stray pointy brackets in ordinary text (but not in `<code>` blocks) are forbidden and must\n    be escaped as entities wherever they appear in attribute values; these rules, however, do not\n    necessarily apply when parsing general MKTS sources. ###\n    ###\n    [\"< >\",[{\"text\":\"< >\",\"$key\":\"^text\"}],null]          # !!! silent failure\n    [\"< x >\",[{\"text\":\"< x >\",\"$key\":\"^text\"}],null]      # !!! silent failure\n    [\"<>\",[{\"text\":\"<>\",\"$key\":\"^text\"}],null]            # !!! silent failure\n    [\"<\",[{\"text\":\"<\",\"$key\":\"^text\"}],null]              # !!! silent failure\n    [\"<tag\",[{\"text\":\"<tag\",\"$key\":\"^text\"}],null]        # !!! silent failure\n    ###\n    [\"if <math> a > b </math> then\",[{\"text\":\"if \",\"$key\":\"^text\"},{\"$key\":\"<math\"},{\"message\":\"Syntax error: closing before opening bracket: \\\" a > b </math> then\\\"\",\"type\":\"mkts-syntax-html\",\"source\":\" a > b </math> then\",\"$key\":\"~error\"}],null]\n    [\">\",[{\"message\":\"Syntax error: closing but no opening bracket: \\\">\\\"\",\"type\":\"mkts-syntax-html\",\"source\":\">\",\"$key\":\"~error\"}],null]\n    [\"&\",[{\"text\":\"&\",\"$key\":\"^text\"}],null]\n    [\"&amp;\",[{\"text\":\"&amp;\",\"$key\":\"^text\"}],null]\n    [\"<tag a='<'>\",[{\"message\":\"Syntax error: additional opening bracket: \\\"<tag a='<'>\\\"\",\"type\":\"mkts-syntax-html\",\"source\":\"<tag a='<'>\",\"$key\":\"~error\"}],null]\n    ]\n  for [ probe, matcher, error, ] in probes_and_matchers\n    await T.perform probe, matcher, error, -> return new Promise ( resolve, reject ) ->\n      resolve MKTS.html_as_datoms probe\n  #.........................................................................................................\n  done()\n  return null\n\n\n#===========================================================================================================\n# DEMOS\n#-----------------------------------------------------------------------------------------------------------\n@[ \"MKTS demo\" ] = ( T, done ) ->\n  text = \"\"\"<!DOCTYPE html>\n  <h1#s4451><strong>CHAPTER VI.</strong> <name ref=hd553>Humpty Dumpty</h1>\n\n  <p#p227.noindent>However, the egg only got larger and larger, and <em>more and more human</em>:<br>\n\n  when she had come within a few yards of it, she saw that it had eyes and a nose and mouth; and when she\n  had come close to it, she saw clearly that it was <name ref=hd556>HUMPTY DUMPTY</name> himself. ‘It can’t\n  be anybody else!’ she said to herself.<br/>\n\n  ‘I’m as certain of it, as if his name were written all over his face.’\n\n  \"\"\"\n  for d in datoms = MKTS.html_as_datoms text\n    echo jr d\n  echo '-'.repeat 108\n  echo result = ( MKTS.datom_as_html d for d in datoms ).join ''\n  # debug '^2228^', jr result\n  T.eq result, \"<!DOCTYPE html>\\n<h1 id=s4451><strong>CHAPTER VI.</strong> \\\n    <name ref=hd553>Humpty Dumpty</h1>\\n\\n<p class=noindent id=p227>However, the egg only got larger and larger, \\\n    and <em>more and more human</em>:<br>\\n\\nwhen she had come within a few yards of it, she saw that it \\\n    had eyes and a nose and mouth; and when she\\nhad come close to it, she saw clearly that it was \\\n    <name ref=hd556>HUMPTY DUMPTY</name> himself. ‘It can’t\\nbe anybody else!’ she said to herself.\\\n    <br></br>\\n\\n‘I’m as certain of it, as if his name were written all over his face.’\\n\"\n  #.........................................................................................................\n  done()\n  return null\n\n#-----------------------------------------------------------------------------------------------------------\n@[ \"MKTS demo (buffer)\" ] = ( T, done ) ->\n  text    = \"\"\"<!DOCTYPE html>\n  <h1#c4443><strong.myclass>CHAPTER VI.</strong> <name ref=hd553>Humpty Dumpty</h1>\"\"\"\n  buffer  = Buffer.from text\n  # debug '^80009^', buffer\n  # for d in datoms = MKTS.html_as_datoms buffer\n  for d in datoms = MKTS.html_as_datoms buffer\n    echo jr d\n  echo '-'.repeat 108\n  echo result = ( MKTS.datom_as_html d for d in datoms ).join ''\n  T.eq result, \"<!DOCTYPE html>\\n<h1 id=c4443><strong class=myclass>CHAPTER VI.</strong> <name ref=hd553>Humpty Dumpty</h1>\"\n  #.........................................................................................................\n  done()\n  return null\n\n\n############################################################################################################\nif module is require.main then do => # await do =>\n  # await @_demo()\n  await test @\n  # await test @[ \"MKTS.html_as_datoms\" ]\n  # await test @[ \"MKTS.html_as_datoms (compact syntax)\" ]\n  # await test @[ \"MKTS.$html_as_datoms\" ]\n  # await test @[ \"MKTS.html_as_datoms (dubious)\" ]\n  # await test @[ \"MKTS demo\" ]\n  # await test @[ \"MKTS demo (buffer)\" ]\n"
  ]
}